<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="LapBadDebt" language="groovy" pageWidth="1003" pageHeight="791" columnWidth="989" leftMargin="7" rightMargin="7" topMargin="20" bottomMargin="20" uuid="ce654fd0-a484-41ff-a362-fd66363edfa6">
	<property name="ireport.zoom" value="1.7715610000000017"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="C_BPartner_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="C_SalesRegion_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="AD_Org_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="C_Period_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT
    row_number() over() as row_no,
	bp.ad_client_id,
    bp.ad_org_id,
    bp.c_bpartner_id,
    bp.value AS bp_value,
    bp.name AS bp_name,
    bp.name2 AS bp_name2,
    y.c_year_id,
    y.fiscalyear,
    y.year,
	TRIM(REPLACE(og.name, 'TDI', '')) as nama_cab, --melepas TDI : TDI MADIUN menjadi MADIUN
	sr.name as sls_rayon,
	tdi_getperiodname($P{C_Period_ID}, 12) as curr_period_name, --kasih nilai 12 aja
    sr.c_salesregion_id AS invoice_sr_id,
		 -- ## OPEN AMOUNT LAST YEAR ##
        (round(COALESCE(( SELECT sum(invoiceopen(ib.c_invoice_id, 0::numeric)) AS sum
								  FROM rv_c_invoice_tdi ib
								  INNER JOIN c_invoice ibo ON ibo.c_invoice_id = ib.c_invoice_id
								  INNER JOIN c_period pb ON pb.c_period_id = ibo.c_period_id
								  INNER JOIN c_year yb ON yb.c_year_id = pb.c_year_id
							      WHERE ib.c_bpartner_id = bp.c_bpartner_id AND ib.c_doctype_id = 1000002::numeric
								  AND yb.year = (y.year - 1::numeric)
								  AND ibo.c_salesregion_id = sr.c_salesregion_id), 0::numeric))
		) AS openamt_lastyear,
         -- ## BAD DEBT LAST YEAR ##
		(round(COALESCE(( SELECT sum(invoiceopen(ib.c_invoice_id, 0::numeric)) AS sum
								  FROM rv_c_invoice_tdi ib
								  INNER JOIN c_invoice ibo ON ibo.c_invoice_id = ib.c_invoice_id
								  INNER JOIN c_period pb ON pb.c_period_id = ibo.c_period_id
								  INNER JOIN c_year yb ON yb.c_year_id = pb.c_year_id
								  WHERE ib.c_bpartner_id = bp.c_bpartner_id AND ib.c_doctype_id = 1000002::numeric
								  AND yb.year = (y.year - 1::numeric) AND ibo.c_salesregion_id = sr.c_salesregion_id
								  AND date_part('day'::text, CURRENT_DATE::timestamp without time zone - ib.dateinvoiced) > 90::double precision), 0::numeric))
		) AS baddebt_lastyear,
		 -- ## BULAN/COL 1 ##
        CASE
			--cond_1
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
                    JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 1) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 1))) = 0::numeric
			THEN 'X'::text
			--cond_2
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 1) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 1) AND ii.isdatacutoff = 'Y'::bpchar
					AND ii.documentno::text = ((( SELECT ixt.documentno
												  FROM tdi_invoice ixt
												  JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												  JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												  JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												  WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 1)
												  AND ixt.c_salesregion_id = sr.c_salesregion_id AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 1)
												  AND ixt.documentno::text = ii.documentno::text))::text))) = 0::numeric
			THEN 'X'::text
			--cond_3
            WHEN (( SELECT sum(ixt.grandtotal) AS sum
					FROM tdi_invoice ixt
					JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
					JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
					JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
					WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 1) AND ixt.c_salesregion_id = sr.c_salesregion_id
					AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 1)
					AND NOT (ixt.documentno::text IN ( SELECT c_invoice.documentno FROM c_invoice)))) IS NOT NULL
			THEN 'X'::text
			--cond_4
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 1) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 1))) > 0::numeric
				AND --cond_5
					round(( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
							FROM rv_c_invoice_tdi i
							JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
							JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
							INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
							INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
							INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
						    WHERE invoiceopen(i.c_invoice_id, 0::numeric) <> 0::numeric AND (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar]))
							AND bps.c_bpartner_id = bp.c_bpartner_id AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 1) AND ii.c_salesregion_id = sr.c_salesregion_id
							AND ii.c_doctype_id = 1000002::numeric
							AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 1))) <>
					--cond_6
					round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
									 FROM c_invoice ix
									 JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
									 JOIN c_period prx ON prx.c_period_id = ix.c_period_id
									 JOIN c_year yx ON yx.c_year_id = prx.c_year_id
									 WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 1)
									 AND ix.isdatacutoff = 'N'::bpchar AND ix.docstatus = 'CO'::bpchar
					                 AND ix.issotrx = 'Y'::bpchar
									 AND ix.c_salesregion_id = sr.c_salesregion_id
									 AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 1)), 0::numeric) +
									 --cond_7
									 COALESCE(( SELECT sum(ixt.grandtotal) AS sum
												FROM tdi_invoice ixt
												JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												WHERE ixt.c_bpartner_id = bp.c_bpartner_id
												AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 1)
												AND ixt.c_salesregion_id = sr.c_salesregion_id
												AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 1)), 0::numeric))
			THEN 'C'::text
            ELSE NULL::text
        END AS col_1_sts,
        (round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 1)
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						  AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 1)
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 1)
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
						 AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 1)
					    ), 0::numeric))
		) AS col_1_val,
		tdi_getperiodname($P{C_Period_ID}, 1) as col_1_name,
		 -- ## BULAN/COL 2 ##
        CASE
			--cond_1
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
                    JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 2) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 2))) = 0::numeric
			THEN 'X'::text
			--cond_2
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 2) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 2) AND ii.isdatacutoff = 'Y'::bpchar
					AND ii.documentno::text = ((( SELECT ixt.documentno
												  FROM tdi_invoice ixt
												  JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												  JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												  JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												  WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 2)
												  AND ixt.c_salesregion_id = sr.c_salesregion_id AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 2)
												  AND ixt.documentno::text = ii.documentno::text))::text))) = 0::numeric
			THEN 'X'::text
			--cond_3
            WHEN (( SELECT sum(ixt.grandtotal) AS sum
					FROM tdi_invoice ixt
					JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
					JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
					JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
					WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 2) AND ixt.c_salesregion_id = sr.c_salesregion_id
					AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 2)
					AND NOT (ixt.documentno::text IN ( SELECT c_invoice.documentno FROM c_invoice)))) IS NOT NULL
			THEN 'X'::text
			--cond_4
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 2) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 2))) > 0::numeric
				AND --cond_5
					round(( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
							FROM rv_c_invoice_tdi i
							JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
							JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
							INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
							INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
							INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
						    WHERE invoiceopen(i.c_invoice_id, 0::numeric) <> 0::numeric AND (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar]))
							AND bps.c_bpartner_id = bp.c_bpartner_id AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 2) AND ii.c_salesregion_id = sr.c_salesregion_id
							AND ii.c_doctype_id = 1000002::numeric
							AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 2))) <>
					--cond_6
					round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
									 FROM c_invoice ix
									 JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
									 JOIN c_period prx ON prx.c_period_id = ix.c_period_id
									 JOIN c_year yx ON yx.c_year_id = prx.c_year_id
									 WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 2)
									 AND ix.isdatacutoff = 'N'::bpchar AND ix.docstatus = 'CO'::bpchar
					                 AND ix.issotrx = 'Y'::bpchar
									 AND ix.c_salesregion_id = sr.c_salesregion_id
									 AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 2)), 0::numeric) +
									 --cond_7
									 COALESCE(( SELECT sum(ixt.grandtotal) AS sum
												FROM tdi_invoice ixt
												JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												WHERE ixt.c_bpartner_id = bp.c_bpartner_id
												AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 2)
												AND ixt.c_salesregion_id = sr.c_salesregion_id
												AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 2)), 0::numeric))
			THEN 'C'::text
            ELSE NULL::text
        END AS col_2_sts,
        (round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 2)
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						  AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 2)
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 2)
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
						 AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 2)
					    ), 0::numeric))
		) AS col_2_val,
		tdi_getperiodname($P{C_Period_ID}, 2) as col_2_name,
		 -- ## BULAN/COL 3 ##
        CASE
			--cond_1
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
                    JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 3) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 3))) = 0::numeric
			THEN 'X'::text
			--cond_2
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 3) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 3) AND ii.isdatacutoff = 'Y'::bpchar
					AND ii.documentno::text = ((( SELECT ixt.documentno
												  FROM tdi_invoice ixt
												  JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												  JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												  JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												  WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 3)
												  AND ixt.c_salesregion_id = sr.c_salesregion_id AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 3)
												  AND ixt.documentno::text = ii.documentno::text))::text))) = 0::numeric
			THEN 'X'::text
			--cond_3
            WHEN (( SELECT sum(ixt.grandtotal) AS sum
					FROM tdi_invoice ixt
					JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
					JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
					JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
					WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 3) AND ixt.c_salesregion_id = sr.c_salesregion_id
					AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 3)
					AND NOT (ixt.documentno::text IN ( SELECT c_invoice.documentno FROM c_invoice)))) IS NOT NULL
			THEN 'X'::text
			--cond_4
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 3) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 3))) > 0::numeric
				AND --cond_5
					round(( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
							FROM rv_c_invoice_tdi i
							JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
							JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
							INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
							INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
							INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
						    WHERE invoiceopen(i.c_invoice_id, 0::numeric) <> 0::numeric AND (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar]))
							AND bps.c_bpartner_id = bp.c_bpartner_id AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 3) AND ii.c_salesregion_id = sr.c_salesregion_id
							AND ii.c_doctype_id = 1000002::numeric
							AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 3))) <>
					--cond_6
					round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
									 FROM c_invoice ix
									 JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
									 JOIN c_period prx ON prx.c_period_id = ix.c_period_id
									 JOIN c_year yx ON yx.c_year_id = prx.c_year_id
									 WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 3)
									 AND ix.isdatacutoff = 'N'::bpchar AND ix.docstatus = 'CO'::bpchar
					                 AND ix.issotrx = 'Y'::bpchar
									 AND ix.c_salesregion_id = sr.c_salesregion_id
									 AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 3)), 0::numeric) +
									 --cond_7
									 COALESCE(( SELECT sum(ixt.grandtotal) AS sum
												FROM tdi_invoice ixt
												JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												WHERE ixt.c_bpartner_id = bp.c_bpartner_id
												AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 3)
												AND ixt.c_salesregion_id = sr.c_salesregion_id
												AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 3)), 0::numeric))
			THEN 'C'::text
            ELSE NULL::text
        END AS col_3_sts,
        (round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 3)
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						  AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 3)
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 3)
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
						 AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 3)
					    ), 0::numeric))
		) AS col_3_val,
		tdi_getperiodname($P{C_Period_ID}, 3) as col_3_name,
		 -- ## BULAN/COL 4 ##
        CASE
			--cond_1
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
                    JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 4) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 4))) = 0::numeric
			THEN 'X'::text
			--cond_2
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 4) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 4) AND ii.isdatacutoff = 'Y'::bpchar
					AND ii.documentno::text = ((( SELECT ixt.documentno
												  FROM tdi_invoice ixt
												  JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												  JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												  JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												  WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 4)
												  AND ixt.c_salesregion_id = sr.c_salesregion_id AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 4)
												  AND ixt.documentno::text = ii.documentno::text))::text))) = 0::numeric
			THEN 'X'::text
			--cond_3
            WHEN (( SELECT sum(ixt.grandtotal) AS sum
					FROM tdi_invoice ixt
					JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
					JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
					JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
					WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 4) AND ixt.c_salesregion_id = sr.c_salesregion_id
					AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 4)
					AND NOT (ixt.documentno::text IN ( SELECT c_invoice.documentno FROM c_invoice)))) IS NOT NULL
			THEN 'X'::text
			--cond_4
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 4) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 4))) > 0::numeric
				AND --cond_5
					round(( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
							FROM rv_c_invoice_tdi i
							JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
							JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
							INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
							INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
							INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
						    WHERE invoiceopen(i.c_invoice_id, 0::numeric) <> 0::numeric AND (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar]))
							AND bps.c_bpartner_id = bp.c_bpartner_id AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 4) AND ii.c_salesregion_id = sr.c_salesregion_id
							AND ii.c_doctype_id = 1000002::numeric
							AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 4))) <>
					--cond_6
					round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
									 FROM c_invoice ix
									 JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
									 JOIN c_period prx ON prx.c_period_id = ix.c_period_id
									 JOIN c_year yx ON yx.c_year_id = prx.c_year_id
									 WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 4)
									 AND ix.isdatacutoff = 'N'::bpchar AND ix.docstatus = 'CO'::bpchar
					                 AND ix.issotrx = 'Y'::bpchar
									 AND ix.c_salesregion_id = sr.c_salesregion_id
									 AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 4)), 0::numeric) +
									 --cond_7
									 COALESCE(( SELECT sum(ixt.grandtotal) AS sum
												FROM tdi_invoice ixt
												JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												WHERE ixt.c_bpartner_id = bp.c_bpartner_id
												AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 4)
												AND ixt.c_salesregion_id = sr.c_salesregion_id
												AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 4)), 0::numeric))
			THEN 'C'::text
            ELSE NULL::text
        END AS col_4_sts,
        (round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 4)
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						  AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 4)
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 4)
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
						 AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 4)
					    ), 0::numeric))
		) AS col_4_val,
		tdi_getperiodname($P{C_Period_ID}, 4) as col_4_name,
		 -- ## BULAN/COL 5 ##
        CASE
			--cond_1
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
                    JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 5) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 5))) = 0::numeric
			THEN 'X'::text
			--cond_2
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 5) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 5) AND ii.isdatacutoff = 'Y'::bpchar
					AND ii.documentno::text = ((( SELECT ixt.documentno
												  FROM tdi_invoice ixt
												  JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												  JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												  JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												  WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 5)
												  AND ixt.c_salesregion_id = sr.c_salesregion_id AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 5)
												  AND ixt.documentno::text = ii.documentno::text))::text))) = 0::numeric
			THEN 'X'::text
			--cond_3
            WHEN (( SELECT sum(ixt.grandtotal) AS sum
					FROM tdi_invoice ixt
					JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
					JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
					JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
					WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 5) AND ixt.c_salesregion_id = sr.c_salesregion_id
					AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 5)
					AND NOT (ixt.documentno::text IN ( SELECT c_invoice.documentno FROM c_invoice)))) IS NOT NULL
			THEN 'X'::text
			--cond_4
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 5) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 5))) > 0::numeric
				AND --cond_5
					round(( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
							FROM rv_c_invoice_tdi i
							JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
							JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
							INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
							INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
							INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
						    WHERE invoiceopen(i.c_invoice_id, 0::numeric) <> 0::numeric AND (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar]))
							AND bps.c_bpartner_id = bp.c_bpartner_id AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 5) AND ii.c_salesregion_id = sr.c_salesregion_id
							AND ii.c_doctype_id = 1000002::numeric
							AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 5))) <>
					--cond_6
					round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
									 FROM c_invoice ix
									 JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
									 JOIN c_period prx ON prx.c_period_id = ix.c_period_id
									 JOIN c_year yx ON yx.c_year_id = prx.c_year_id
									 WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 5)
									 AND ix.isdatacutoff = 'N'::bpchar AND ix.docstatus = 'CO'::bpchar
					                 AND ix.issotrx = 'Y'::bpchar
									 AND ix.c_salesregion_id = sr.c_salesregion_id
									 AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 5)), 0::numeric) +
									 --cond_7
									 COALESCE(( SELECT sum(ixt.grandtotal) AS sum
												FROM tdi_invoice ixt
												JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												WHERE ixt.c_bpartner_id = bp.c_bpartner_id
												AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 5)
												AND ixt.c_salesregion_id = sr.c_salesregion_id
												AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 5)), 0::numeric))
			THEN 'C'::text
            ELSE NULL::text
        END AS col_5_sts,
        (round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 5)
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						  AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 5)
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 5)
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
						 AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 5)
					    ), 0::numeric))
		) AS col_5_val,
		tdi_getperiodname($P{C_Period_ID}, 5) as col_5_name,
		 -- ## BULAN/COL 6 ##
        CASE
			--cond_1
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
                    JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 6) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 6))) = 0::numeric
			THEN 'X'::text
			--cond_2
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 6) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 6) AND ii.isdatacutoff = 'Y'::bpchar
					AND ii.documentno::text = ((( SELECT ixt.documentno
												  FROM tdi_invoice ixt
												  JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												  JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												  JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												  WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 6)
												  AND ixt.c_salesregion_id = sr.c_salesregion_id AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 6)
												  AND ixt.documentno::text = ii.documentno::text))::text))) = 0::numeric
			THEN 'X'::text
			--cond_3
            WHEN (( SELECT sum(ixt.grandtotal) AS sum
					FROM tdi_invoice ixt
					JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
					JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
					JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
					WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 6) AND ixt.c_salesregion_id = sr.c_salesregion_id
					AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 6)
					AND NOT (ixt.documentno::text IN ( SELECT c_invoice.documentno FROM c_invoice)))) IS NOT NULL
			THEN 'X'::text
			--cond_4
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 6) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 6))) > 0::numeric
				AND --cond_5
					round(( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
							FROM rv_c_invoice_tdi i
							JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
							JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
							INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
							INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
							INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
						    WHERE invoiceopen(i.c_invoice_id, 0::numeric) <> 0::numeric AND (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar]))
							AND bps.c_bpartner_id = bp.c_bpartner_id AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 6) AND ii.c_salesregion_id = sr.c_salesregion_id
							AND ii.c_doctype_id = 1000002::numeric
							AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 6))) <>
					--cond_6
					round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
									 FROM c_invoice ix
									 JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
									 JOIN c_period prx ON prx.c_period_id = ix.c_period_id
									 JOIN c_year yx ON yx.c_year_id = prx.c_year_id
									 WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 6)
									 AND ix.isdatacutoff = 'N'::bpchar AND ix.docstatus = 'CO'::bpchar
					                 AND ix.issotrx = 'Y'::bpchar
									 AND ix.c_salesregion_id = sr.c_salesregion_id
									 AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 6)), 0::numeric) +
									 --cond_7
									 COALESCE(( SELECT sum(ixt.grandtotal) AS sum
												FROM tdi_invoice ixt
												JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												WHERE ixt.c_bpartner_id = bp.c_bpartner_id
												AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 6)
												AND ixt.c_salesregion_id = sr.c_salesregion_id
												AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 6)), 0::numeric))
			THEN 'C'::text
            ELSE NULL::text
        END AS col_6_sts,
        (round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 6)
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						  AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 6)
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 6)
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
						 AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 6)
					    ), 0::numeric))
		) AS col_6_val,
		tdi_getperiodname($P{C_Period_ID}, 6) as col_6_name,
		 -- ## BULAN/COL 7 ##
        CASE
			--cond_1
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
                    JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 7) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 7))) = 0::numeric
			THEN 'X'::text
			--cond_2
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 7) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 7) AND ii.isdatacutoff = 'Y'::bpchar
					AND ii.documentno::text = ((( SELECT ixt.documentno
												  FROM tdi_invoice ixt
												  JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												  JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												  JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												  WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 7)
												  AND ixt.c_salesregion_id = sr.c_salesregion_id AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 7)
												  AND ixt.documentno::text = ii.documentno::text))::text))) = 0::numeric
			THEN 'X'::text
			--cond_3
            WHEN (( SELECT sum(ixt.grandtotal) AS sum
					FROM tdi_invoice ixt
					JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
					JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
					JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
					WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 7) AND ixt.c_salesregion_id = sr.c_salesregion_id
					AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 7)
					AND NOT (ixt.documentno::text IN ( SELECT c_invoice.documentno FROM c_invoice)))) IS NOT NULL
			THEN 'X'::text
			--cond_4
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 7) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 7))) > 0::numeric
				AND --cond_5
					round(( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
							FROM rv_c_invoice_tdi i
							JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
							JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
							INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
							INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
							INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
						    WHERE invoiceopen(i.c_invoice_id, 0::numeric) <> 0::numeric AND (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar]))
							AND bps.c_bpartner_id = bp.c_bpartner_id AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 7) AND ii.c_salesregion_id = sr.c_salesregion_id
							AND ii.c_doctype_id = 1000002::numeric
							AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 7))) <>
					--cond_6
					round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
									 FROM c_invoice ix
									 JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
									 JOIN c_period prx ON prx.c_period_id = ix.c_period_id
									 JOIN c_year yx ON yx.c_year_id = prx.c_year_id
									 WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 7)
									 AND ix.isdatacutoff = 'N'::bpchar AND ix.docstatus = 'CO'::bpchar
					                 AND ix.issotrx = 'Y'::bpchar
									 AND ix.c_salesregion_id = sr.c_salesregion_id
									 AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 7)), 0::numeric) +
									 --cond_7
									 COALESCE(( SELECT sum(ixt.grandtotal) AS sum
												FROM tdi_invoice ixt
												JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												WHERE ixt.c_bpartner_id = bp.c_bpartner_id
												AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 7)
												AND ixt.c_salesregion_id = sr.c_salesregion_id
												AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 7)), 0::numeric))
			THEN 'C'::text
            ELSE NULL::text
        END AS col_7_sts,
        (round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 7)
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						  AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 7)
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 7)
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
						 AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 7)
					    ), 0::numeric))
		) AS col_7_val,
		tdi_getperiodname($P{C_Period_ID}, 7) as col_7_name,
		 -- ## BULAN/COL 8 ##
        CASE
			--cond_1
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
                    JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 8) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 8))) = 0::numeric
			THEN 'X'::text
			--cond_2
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 8) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 8) AND ii.isdatacutoff = 'Y'::bpchar
					AND ii.documentno::text = ((( SELECT ixt.documentno
												  FROM tdi_invoice ixt
												  JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												  JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												  JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												  WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 8)
												  AND ixt.c_salesregion_id = sr.c_salesregion_id AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 8)
												  AND ixt.documentno::text = ii.documentno::text))::text))) = 0::numeric
			THEN 'X'::text
			--cond_3
            WHEN (( SELECT sum(ixt.grandtotal) AS sum
					FROM tdi_invoice ixt
					JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
					JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
					JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
					WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 8) AND ixt.c_salesregion_id = sr.c_salesregion_id
					AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 8)
					AND NOT (ixt.documentno::text IN ( SELECT c_invoice.documentno FROM c_invoice)))) IS NOT NULL
			THEN 'X'::text
			--cond_4
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 8) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 8))) > 0::numeric
				AND --cond_5
					round(( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
							FROM rv_c_invoice_tdi i
							JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
							JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
							INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
							INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
							INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
						    WHERE invoiceopen(i.c_invoice_id, 0::numeric) <> 0::numeric AND (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar]))
							AND bps.c_bpartner_id = bp.c_bpartner_id AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 8) AND ii.c_salesregion_id = sr.c_salesregion_id
							AND ii.c_doctype_id = 1000002::numeric
							AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 8))) <>
					--cond_6
					round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
									 FROM c_invoice ix
									 JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
									 JOIN c_period prx ON prx.c_period_id = ix.c_period_id
									 JOIN c_year yx ON yx.c_year_id = prx.c_year_id
									 WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 8)
									 AND ix.isdatacutoff = 'N'::bpchar AND ix.docstatus = 'CO'::bpchar
					                 AND ix.issotrx = 'Y'::bpchar
									 AND ix.c_salesregion_id = sr.c_salesregion_id
									 AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 8)), 0::numeric) +
									 --cond_7
									 COALESCE(( SELECT sum(ixt.grandtotal) AS sum
												FROM tdi_invoice ixt
												JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												WHERE ixt.c_bpartner_id = bp.c_bpartner_id
												AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 8)
												AND ixt.c_salesregion_id = sr.c_salesregion_id
												AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 8)), 0::numeric))
			THEN 'C'::text
            ELSE NULL::text
        END AS col_8_sts,
        (round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 8)
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						  AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 8)
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 8)
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
						 AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 8)
					    ), 0::numeric))
		) AS col_8_val,
		tdi_getperiodname($P{C_Period_ID}, 8) as col_8_name,
		 -- ## BULAN/COL 9 ##
        CASE
			--cond_1
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
                    JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 9) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 9))) = 0::numeric
			THEN 'X'::text
			--cond_2
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 9) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 9) AND ii.isdatacutoff = 'Y'::bpchar
					AND ii.documentno::text = ((( SELECT ixt.documentno
												  FROM tdi_invoice ixt
												  JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												  JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												  JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												  WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 9)
												  AND ixt.c_salesregion_id = sr.c_salesregion_id AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 9)
												  AND ixt.documentno::text = ii.documentno::text))::text))) = 0::numeric
			THEN 'X'::text
			--cond_3
            WHEN (( SELECT sum(ixt.grandtotal) AS sum
					FROM tdi_invoice ixt
					JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
					JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
					JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
					WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 9) AND ixt.c_salesregion_id = sr.c_salesregion_id
					AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 9)
					AND NOT (ixt.documentno::text IN ( SELECT c_invoice.documentno FROM c_invoice)))) IS NOT NULL
			THEN 'X'::text
			--cond_4
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 9) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 9))) > 0::numeric
				AND --cond_5
					round(( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
							FROM rv_c_invoice_tdi i
							JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
							JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
							INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
							INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
							INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
						    WHERE invoiceopen(i.c_invoice_id, 0::numeric) <> 0::numeric AND (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar]))
							AND bps.c_bpartner_id = bp.c_bpartner_id AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 9) AND ii.c_salesregion_id = sr.c_salesregion_id
							AND ii.c_doctype_id = 1000002::numeric
							AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 9))) <>
					--cond_6
					round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
									 FROM c_invoice ix
									 JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
									 JOIN c_period prx ON prx.c_period_id = ix.c_period_id
									 JOIN c_year yx ON yx.c_year_id = prx.c_year_id
									 WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 9)
									 AND ix.isdatacutoff = 'N'::bpchar AND ix.docstatus = 'CO'::bpchar
					                 AND ix.issotrx = 'Y'::bpchar
									 AND ix.c_salesregion_id = sr.c_salesregion_id
									 AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 9)), 0::numeric) +
									 --cond_7
									 COALESCE(( SELECT sum(ixt.grandtotal) AS sum
												FROM tdi_invoice ixt
												JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												WHERE ixt.c_bpartner_id = bp.c_bpartner_id
												AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 9)
												AND ixt.c_salesregion_id = sr.c_salesregion_id
												AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 9)), 0::numeric))
			THEN 'C'::text
            ELSE NULL::text
        END AS col_9_sts,
        (round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 9)
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						  AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 9)
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 9)
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
						 AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 9)
					    ), 0::numeric))
		) AS col_9_val,
		tdi_getperiodname($P{C_Period_ID}, 9) as col_9_name,
		 -- ## BULAN/COL 10 ##
        CASE
			--cond_1
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
                    JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 10) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 10))) = 0::numeric
			THEN 'X'::text
			--cond_2
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 10) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 10) AND ii.isdatacutoff = 'Y'::bpchar
					AND ii.documentno::text = ((( SELECT ixt.documentno
												  FROM tdi_invoice ixt
												  JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												  JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												  JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												  WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 10)
												  AND ixt.c_salesregion_id = sr.c_salesregion_id AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 10)
												  AND ixt.documentno::text = ii.documentno::text))::text))) = 0::numeric
			THEN 'X'::text
			--cond_3
            WHEN (( SELECT sum(ixt.grandtotal) AS sum
					FROM tdi_invoice ixt
					JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
					JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
					JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
					WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 10) AND ixt.c_salesregion_id = sr.c_salesregion_id
					AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 10)
					AND NOT (ixt.documentno::text IN ( SELECT c_invoice.documentno FROM c_invoice)))) IS NOT NULL
			THEN 'X'::text
			--cond_4
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 10) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 10))) > 0::numeric
				AND --cond_5
					round(( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
							FROM rv_c_invoice_tdi i
							JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
							JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
							INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
							INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
							INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
						    WHERE invoiceopen(i.c_invoice_id, 0::numeric) <> 0::numeric AND (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar]))
							AND bps.c_bpartner_id = bp.c_bpartner_id AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 10) AND ii.c_salesregion_id = sr.c_salesregion_id
							AND ii.c_doctype_id = 1000002::numeric
							AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 10))) <>
					--cond_6
					round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
									 FROM c_invoice ix
									 JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
									 JOIN c_period prx ON prx.c_period_id = ix.c_period_id
									 JOIN c_year yx ON yx.c_year_id = prx.c_year_id
									 WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 10)
									 AND ix.isdatacutoff = 'N'::bpchar AND ix.docstatus = 'CO'::bpchar
					                 AND ix.issotrx = 'Y'::bpchar
									 AND ix.c_salesregion_id = sr.c_salesregion_id
									 AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 10)), 0::numeric) +
									 --cond_7
									 COALESCE(( SELECT sum(ixt.grandtotal) AS sum
												FROM tdi_invoice ixt
												JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												WHERE ixt.c_bpartner_id = bp.c_bpartner_id
												AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 10)
												AND ixt.c_salesregion_id = sr.c_salesregion_id
												AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 10)), 0::numeric))
			THEN 'C'::text
            ELSE NULL::text
        END AS col_10_sts,
        (round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 10)
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						  AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 10)
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 10)
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
						 AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 10)
					    ), 0::numeric))
		) AS col_10_val,
		tdi_getperiodname($P{C_Period_ID}, 10) as col_10_name,
		 -- ## BULAN/COL 11 ##
        CASE
			--cond_1
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
                    JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 11) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 11))) = 0::numeric
			THEN 'X'::text
			--cond_2
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 11) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 11) AND ii.isdatacutoff = 'Y'::bpchar
					AND ii.documentno::text = ((( SELECT ixt.documentno
												  FROM tdi_invoice ixt
												  JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												  JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												  JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												  WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 11)
												  AND ixt.c_salesregion_id = sr.c_salesregion_id AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 11)
												  AND ixt.documentno::text = ii.documentno::text))::text))) = 0::numeric
			THEN 'X'::text
			--cond_3
            WHEN (( SELECT sum(ixt.grandtotal) AS sum
					FROM tdi_invoice ixt
					JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
					JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
					JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
					WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 11) AND ixt.c_salesregion_id = sr.c_salesregion_id
					AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 11)
					AND NOT (ixt.documentno::text IN ( SELECT c_invoice.documentno FROM c_invoice)))) IS NOT NULL
			THEN 'X'::text
			--cond_4
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 11) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 11))) > 0::numeric
				AND --cond_5
					round(( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
							FROM rv_c_invoice_tdi i
							JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
							JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
							INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
							INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
							INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
						    WHERE invoiceopen(i.c_invoice_id, 0::numeric) <> 0::numeric AND (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar]))
							AND bps.c_bpartner_id = bp.c_bpartner_id AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 11) AND ii.c_salesregion_id = sr.c_salesregion_id
							AND ii.c_doctype_id = 1000002::numeric
							AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 11))) <>
					--cond_6
					round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
									 FROM c_invoice ix
									 JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
									 JOIN c_period prx ON prx.c_period_id = ix.c_period_id
									 JOIN c_year yx ON yx.c_year_id = prx.c_year_id
									 WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 11)
									 AND ix.isdatacutoff = 'N'::bpchar AND ix.docstatus = 'CO'::bpchar
					                 AND ix.issotrx = 'Y'::bpchar
									 AND ix.c_salesregion_id = sr.c_salesregion_id
									 AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 11)), 0::numeric) +
									 --cond_7
									 COALESCE(( SELECT sum(ixt.grandtotal) AS sum
												FROM tdi_invoice ixt
												JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												WHERE ixt.c_bpartner_id = bp.c_bpartner_id
												AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 11)
												AND ixt.c_salesregion_id = sr.c_salesregion_id
												AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 11)), 0::numeric))
			THEN 'C'::text
            ELSE NULL::text
        END AS col_11_sts,
        (round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 11)
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						  AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 11)
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 11)
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
						 AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 11)
					    ), 0::numeric))
		) AS col_11_val,
		tdi_getperiodname($P{C_Period_ID}, 11) as col_11_name,
		 -- ## BULAN/COL 12 ##
        CASE
			--cond_1
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
                    JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 12) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 12))) = 0::numeric
			THEN 'X'::text
			--cond_2
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 12) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 12) AND ii.isdatacutoff = 'Y'::bpchar
					AND ii.documentno::text = ((( SELECT ixt.documentno
												  FROM tdi_invoice ixt
												  JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												  JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												  JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												  WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 12)
												  AND ixt.c_salesregion_id = sr.c_salesregion_id AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 12)
												  AND ixt.documentno::text = ii.documentno::text))::text))) = 0::numeric
			THEN 'X'::text
			--cond_3
            WHEN (( SELECT sum(ixt.grandtotal) AS sum
					FROM tdi_invoice ixt
					JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
					JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
					JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
					WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 12) AND ixt.c_salesregion_id = sr.c_salesregion_id
					AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 12)
					AND NOT (ixt.documentno::text IN ( SELECT c_invoice.documentno FROM c_invoice)))) IS NOT NULL
			THEN 'X'::text
			--cond_4
            WHEN (( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
					FROM rv_c_invoice_tdi i
					JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
					JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
					INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
					INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
					INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
					WHERE (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar])) AND bps.c_bpartner_id = bp.c_bpartner_id
					AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 12) AND ii.c_salesregion_id = sr.c_salesregion_id AND ii.c_doctype_id = 1000002::numeric
					AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 12))) > 0::numeric
				AND --cond_5
					round(( SELECT sum(invoiceopen(i.c_invoice_id, 0::numeric)) AS sum
							FROM rv_c_invoice_tdi i
							JOIN c_paymentterm p ON i.c_paymentterm_id = p.c_paymentterm_id
							JOIN c_bpartner bps ON bps.c_bpartner_id = i.c_bpartner_id
							INNER JOIN c_invoice ii ON ii.c_invoice_id = i.c_invoice_id
							INNER JOIN c_period ip ON ip.c_period_id = ii.c_period_id
							INNER JOIN c_year yp ON yp.c_year_id = ip.c_year_id
						    WHERE invoiceopen(i.c_invoice_id, 0::numeric) <> 0::numeric AND (i.docstatus = ANY (ARRAY['CO'::bpchar, 'CL'::bpchar]))
							AND bps.c_bpartner_id = bp.c_bpartner_id AND ip.periodno = tdi_getperiodno($P{C_Period_ID}, 12) AND ii.c_salesregion_id = sr.c_salesregion_id
							AND ii.c_doctype_id = 1000002::numeric
							AND yp.c_year_id = tdi_getyear_id($P{C_Period_ID}, 12))) <>
					--cond_6
					round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
									 FROM c_invoice ix
									 JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
									 JOIN c_period prx ON prx.c_period_id = ix.c_period_id
									 JOIN c_year yx ON yx.c_year_id = prx.c_year_id
									 WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 12)
									 AND ix.isdatacutoff = 'N'::bpchar AND ix.docstatus = 'CO'::bpchar
					                 AND ix.issotrx = 'Y'::bpchar
									 AND ix.c_salesregion_id = sr.c_salesregion_id
									 AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 12)), 0::numeric) +
									 --cond_7
									 COALESCE(( SELECT sum(ixt.grandtotal) AS sum
												FROM tdi_invoice ixt
												JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
												JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
												JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
												WHERE ixt.c_bpartner_id = bp.c_bpartner_id
												AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 12)
												AND ixt.c_salesregion_id = sr.c_salesregion_id
												AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 12)), 0::numeric))
			THEN 'C'::text
            ELSE NULL::text
        END AS col_12_sts,
        (round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 12)
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						  AND prx.periodno = tdi_getperiodno($P{C_Period_ID}, 12)
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 12)
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
						 AND prxt.periodno = tdi_getperiodno($P{C_Period_ID}, 12)
					    ), 0::numeric))
		) AS col_12_val,
		tdi_getperiodname($P{C_Period_ID}, 12) as col_12_name,
		(round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getyear_id($P{C_Period_ID}, 12)
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getyear_id($P{C_Period_ID}, 12)
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
					    ), 0::numeric))
		) AS curr_year_val,
		(SELECT y1.year FROM c_year y1 WHERE y1.c_year_id=tdi_getyear_id($P{C_Period_ID}, 12)) as curr_year_name,
		(round(COALESCE(( SELECT sum(ix.grandtotal) AS sum
						  FROM c_invoice ix
						  JOIN c_bpartner bpx ON bpx.c_bpartner_id = ix.c_bpartner_id
						  JOIN c_period prx ON prx.c_period_id = ix.c_period_id
						  JOIN c_year yx ON yx.c_year_id = prx.c_year_id
						  WHERE ix.c_bpartner_id = bp.c_bpartner_id AND yx.c_year_id = tdi_getprevyear_id(tdi_getyear_id($P{C_Period_ID}, 12))
						  AND ix.isdatacutoff = 'N'::bpchar
						  AND ix.docstatus = 'CO'::bpchar AND ix.issotrx = 'Y'::bpchar AND ix.c_doctype_id = 1000002::numeric
						  AND ix.c_salesregion_id = sr.c_salesregion_id
						), 0::numeric) +
			  COALESCE(( SELECT sum(ixt.grandtotal) AS sum
						 FROM tdi_invoice ixt
						 JOIN c_bpartner bpxt ON bpxt.c_bpartner_id = ixt.c_bpartner_id
						 JOIN c_period prxt ON prxt.c_period_id = ixt.c_period_id
						 JOIN c_year yxt ON yxt.c_year_id = prxt.c_year_id
						 WHERE ixt.c_bpartner_id = bp.c_bpartner_id AND yxt.c_year_id = tdi_getprevyear_id(tdi_getyear_id($P{C_Period_ID}, 12))
						 AND ixt.c_salesregion_id = sr.c_salesregion_id
					    ), 0::numeric))
		) AS prev_year_val,
		(SELECT y1.year-1 FROM c_year y1 WHERE y1.c_year_id=tdi_getyear_id($P{C_Period_ID}, 12)) as prev_year_name -- year-1 biar dapet tahun lalu
   FROM c_bpartner bp
   INNER JOIN c_year y ON y.ad_client_id = bp.ad_client_id
   INNER JOIN c_bpartner_location bpl ON bpl.c_bpartner_id = bp.c_bpartner_id
   INNER JOIN tdi_bplocation_salesregion bpls ON bpls.c_bpartner_location_id = bpl.c_bpartner_location_id
   INNER JOIN c_salesregion sr ON sr.ad_org_id = bp.ad_org_id
   INNER JOIN ad_org og ON og.ad_org_id=bp.ad_org_id
   WHERE (sr.c_salesregion_id IN ( SELECT DISTINCT c_invoice.c_salesregion_id
								   FROM c_invoice
								   WHERE c_invoice.issotrx = 'Y'::bpchar AND c_invoice.c_bpartner_id = bp.c_bpartner_id))
   AND y.c_year_id=(SELECT y.c_year_id FROM c_period prd
					INNER JOIN c_year y ON y.c_year_id=prd.c_year_id
					WHERE prd.c_period_id=$P{C_Period_ID}) --param_period_ID
   AND sr.c_salesregion_id=$P{C_SalesRegion_ID} --Rayon 4A
   AND bp.ad_org_id=$P{AD_Org_ID} --Cabang Madiun
   GROUP BY bp.ad_client_id, bp.ad_org_id, bp.c_bpartner_id, bp.value, bp.name, bp.name2, y.c_year_id, y.fiscalyear, y.year,
            sr.c_salesregion_id, og.name, sr.name
   --ORDER BY sr.name, bp.name]]>
	</queryString>
	<field name="row_no" class="java.lang.Long"/>
	<field name="ad_client_id" class="java.math.BigDecimal"/>
	<field name="ad_org_id" class="java.math.BigDecimal"/>
	<field name="c_bpartner_id" class="java.math.BigDecimal"/>
	<field name="bp_value" class="java.lang.String"/>
	<field name="bp_name" class="java.lang.String"/>
	<field name="bp_name2" class="java.lang.String"/>
	<field name="c_year_id" class="java.math.BigDecimal"/>
	<field name="fiscalyear" class="java.lang.String"/>
	<field name="year" class="java.math.BigDecimal"/>
	<field name="nama_cab" class="java.lang.String"/>
	<field name="sls_rayon" class="java.lang.String"/>
	<field name="curr_period_name" class="java.lang.String"/>
	<field name="invoice_sr_id" class="java.math.BigDecimal"/>
	<field name="openamt_lastyear" class="java.math.BigDecimal"/>
	<field name="baddebt_lastyear" class="java.math.BigDecimal"/>
	<field name="col_1_sts" class="java.lang.String"/>
	<field name="col_1_val" class="java.math.BigDecimal"/>
	<field name="col_1_name" class="java.lang.String"/>
	<field name="col_2_sts" class="java.lang.String"/>
	<field name="col_2_val" class="java.math.BigDecimal"/>
	<field name="col_2_name" class="java.lang.String"/>
	<field name="col_3_sts" class="java.lang.String"/>
	<field name="col_3_val" class="java.math.BigDecimal"/>
	<field name="col_3_name" class="java.lang.String"/>
	<field name="col_4_sts" class="java.lang.String"/>
	<field name="col_4_val" class="java.math.BigDecimal"/>
	<field name="col_4_name" class="java.lang.String"/>
	<field name="col_5_sts" class="java.lang.String"/>
	<field name="col_5_val" class="java.math.BigDecimal"/>
	<field name="col_5_name" class="java.lang.String"/>
	<field name="col_6_sts" class="java.lang.String"/>
	<field name="col_6_val" class="java.math.BigDecimal"/>
	<field name="col_6_name" class="java.lang.String"/>
	<field name="col_7_sts" class="java.lang.String"/>
	<field name="col_7_val" class="java.math.BigDecimal"/>
	<field name="col_7_name" class="java.lang.String"/>
	<field name="col_8_sts" class="java.lang.String"/>
	<field name="col_8_val" class="java.math.BigDecimal"/>
	<field name="col_8_name" class="java.lang.String"/>
	<field name="col_9_sts" class="java.lang.String"/>
	<field name="col_9_val" class="java.math.BigDecimal"/>
	<field name="col_9_name" class="java.lang.String"/>
	<field name="col_10_sts" class="java.lang.String"/>
	<field name="col_10_val" class="java.math.BigDecimal"/>
	<field name="col_10_name" class="java.lang.String"/>
	<field name="col_11_sts" class="java.lang.String"/>
	<field name="col_11_val" class="java.math.BigDecimal"/>
	<field name="col_11_name" class="java.lang.String"/>
	<field name="col_12_sts" class="java.lang.String"/>
	<field name="col_12_val" class="java.math.BigDecimal"/>
	<field name="col_12_name" class="java.lang.String"/>
	<field name="curr_year_val" class="java.math.BigDecimal"/>
	<field name="curr_year_name" class="java.math.BigDecimal"/>
	<field name="prev_year_val" class="java.math.BigDecimal"/>
	<field name="prev_year_name" class="java.math.BigDecimal"/>
	<sortField name="baddebt_lastyear"/>
	<sortField name="prev_year_val" order="Descending"/>
	<variable name="bp_name_1" class="java.lang.Integer" resetType="Column" calculation="Count">
		<variableExpression><![CDATA[$F{bp_name}]]></variableExpression>
	</variable>
	<variable name="baddebt_lastyear_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{baddebt_lastyear}]]></variableExpression>
	</variable>
	<variable name="col_2_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{col_2_val}]]></variableExpression>
	</variable>
	<variable name="col_2_val_2" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{col_2_val}]]></variableExpression>
	</variable>
	<variable name="col_3_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{col_3_val}]]></variableExpression>
	</variable>
	<variable name="col_4_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{col_4_val}]]></variableExpression>
	</variable>
	<variable name="col_5_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{col_5_val}]]></variableExpression>
	</variable>
	<variable name="col_6_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{col_6_val}]]></variableExpression>
	</variable>
	<variable name="col_7_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{col_7_val}]]></variableExpression>
	</variable>
	<variable name="col_8_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{col_8_val}]]></variableExpression>
	</variable>
	<variable name="col_9_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{col_9_val}]]></variableExpression>
	</variable>
	<variable name="col_10_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{col_10_val}]]></variableExpression>
	</variable>
	<variable name="col_11_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{col_11_val}]]></variableExpression>
	</variable>
	<variable name="col_12_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{col_12_val}]]></variableExpression>
	</variable>
	<variable name="curr_year_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{curr_year_val}]]></variableExpression>
	</variable>
	<variable name="prev_year_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{prev_year_val}]]></variableExpression>
	</variable>
	<variable name="col_1_val_1" class="java.math.BigDecimal" resetType="Page" calculation="Sum">
		<variableExpression><![CDATA[$F{col_1_val}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="60" splitType="Stretch">
			<staticText>
				<reportElement x="67" y="31" width="18" height="13" uuid="c7d903a3-b27a-4044-a2e8-b4f2bed55bac"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<textField>
				<reportElement x="1" y="31" width="66" height="13" uuid="fce9404d-38e0-4205-8578-5e16edf7a98e"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression><![CDATA["PERIODE"]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement x="85" y="43" width="60" height="13" uuid="d1afedda-a285-4165-b008-2d6fadcfeb6c"/>
				<textElement verticalAlignment="Bottom">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{sls_rayon}.toUpperCase()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="67" y="18" width="18" height="13" uuid="3a49fe5f-0d9c-4ccd-93a7-731b5e246c05"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="85" y="18" width="100" height="13" uuid="f428780d-77ea-436c-acca-db89d77a9808"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nama_cab}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="1" y="1" width="386" height="15" uuid="fee81a9a-84c3-4e0f-b8b1-1559e39604cc"/>
				<textElement>
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["LAPORAN STATUS PIUTANG "+$F{fiscalyear}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="1" y="43" width="66" height="13" uuid="0ad84b61-14ba-41aa-b365-e9afc1ed5afa"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression><![CDATA["RAYON"]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="67" y="43" width="18" height="13" uuid="bae00f98-1d7a-4427-abd7-5bd4660a960f"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="85" y="31" width="100" height="13" uuid="62cb20c1-2257-4700-8f8d-125c362efeb4"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{curr_period_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="1" y="18" width="65" height="13" uuid="6b3a8046-be31-43f9-8920-a2435b98f4bf"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression><![CDATA["CABANG "]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="715" y="47" width="210" height="13" uuid="6139acad-163f-4a49-aaaa-7e92f115e00d"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression><![CDATA["X=lunas, C=cicil, Blank=belum bayar"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="925" y="47" width="64" height="13" uuid="814422ef-782f-43c2-a0e7-eec82c035a2f"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["HAL. "+$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="33" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="2" width="15" height="31" uuid="f54c76fd-bbd2-4627-aeda-b754904c528b"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<text><![CDATA[NO]]></text>
			</staticText>
			<staticText>
				<reportElement x="15" y="2" width="111" height="31" uuid="8a515f72-50d4-40a0-b618-cf39cb67423a"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[CUSTOMER]]></text>
			</staticText>
			<staticText>
				<reportElement x="126" y="2" width="58" height="31" uuid="5fe7f4cf-76cc-4d09-99cc-77f86d40127e"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<text><![CDATA[BAD DEBT TAHUN LALU]]></text>
			</staticText>
			<textField>
				<reportElement x="184" y="2" width="54" height="31" uuid="987865d0-019c-47bf-917a-c4a88774a4f8"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{col_1_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="238" y="2" width="54" height="31" uuid="53e3261b-0ee9-4030-a178-acd52b53e912"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{col_2_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="292" y="2" width="54" height="31" uuid="c24cb051-265a-49ee-b9d9-105247899158"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{col_3_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="346" y="2" width="54" height="31" uuid="d7b6eb9e-cb68-4f4a-b487-0746baf6cad3"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{col_4_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="400" y="2" width="54" height="31" uuid="992015e7-2959-4d4a-9788-e1ce131c7819"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{col_5_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="454" y="2" width="54" height="31" uuid="b035d189-2c67-45c2-8a9f-d6b23953ae3c"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{col_6_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="508" y="2" width="54" height="31" uuid="060f2b75-3ae2-4887-8392-6bb2d3f0f95a"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{col_7_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="562" y="2" width="54" height="31" uuid="2ff3d87d-90b5-4293-8377-cbda2a7f1ffc"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{col_8_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="616" y="2" width="54" height="31" uuid="cb97fda7-8c82-4b74-9c13-7c91da286804"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{col_9_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="670" y="2" width="54" height="31" uuid="007cb3e3-dc69-484a-87c3-dccbb8c8f684"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{col_10_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="724" y="2" width="54" height="31" uuid="b40042fe-5199-4037-921c-b33d29bae97d"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{col_11_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="778" y="2" width="54" height="31" uuid="d202334f-fe53-4955-8646-6e6748dd0b37"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{col_12_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="894" y="16" width="62" height="17" uuid="d150fcaa-6183-49cf-bd0d-b55f86495b5b"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{prev_year_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="832" y="16" width="62" height="17" uuid="40b2cc2a-2250-4854-86d4-e9b2d7b8fe87"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{curr_year_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="956" y="16" width="33" height="17" uuid="7f30eb17-8812-4384-9ff2-dc7d5408eb5f"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA["(%)"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="832" y="2" width="157" height="14" uuid="c441b90c-b134-49e6-94d8-40334220a5ca"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA["OMSET (Rp.)"]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<detail>
		<band height="16" splitType="Stretch">
			<textField>
				<reportElement x="0" y="0" width="15" height="16" uuid="423288db-fdee-47be-a9b5-9dc8f90e9b60"/>
				<box rightPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{REPORT_COUNT}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement x="15" y="0" width="111" height="16" uuid="eb4af8fe-646b-47a9-9bd9-3dbe638a454d"/>
				<box leftPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{bp_name}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="126" y="0" width="58" height="16" uuid="9fa86cba-47e1-4955-8d02-fc2c4966d5b0"/>
				<box rightPadding="2">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{baddebt_lastyear} > 0 ? $F{baddebt_lastyear} : ""]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="184" y="0" width="54" height="16" uuid="307d9e6d-bc59-4b24-b589-7e5a411a2241"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_1_val} > 0 ? $F{col_1_val} : ""]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="184" y="0" width="10" height="16" uuid="138cb6e7-5901-4f68-bb83-636591672afd"/>
				<box leftPadding="1">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_1_sts}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="238" y="0" width="54" height="16" uuid="a34a7dab-deb0-47b0-8f79-6b604098974c"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_2_val} > 0 ? $F{col_2_val} : ""]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="238" y="0" width="10" height="16" uuid="d74f6270-fb84-4b66-a940-368b26d4e5c1"/>
				<box leftPadding="1">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_2_sts}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="292" y="0" width="10" height="16" uuid="ef0f4769-d043-43c5-b649-693a919857d6"/>
				<box leftPadding="1">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_3_sts}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="292" y="0" width="54" height="16" uuid="6c24b08e-16ef-446e-8a9a-efe981060e50"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_3_val} > 0 ? $F{col_3_val} : ""]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="346" y="0" width="10" height="16" uuid="782dfa13-136a-44f7-886b-d1293919e3a0"/>
				<box leftPadding="1">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_4_sts}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="346" y="0" width="54" height="16" uuid="bb1ebff7-f026-46a5-ba90-8ef5aba2ee77"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_4_val} > 0 ? $F{col_4_val} : ""]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="399" y="0" width="10" height="16" uuid="fdf6f8a3-adcf-4385-a435-b3098996e6f3"/>
				<box leftPadding="1">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_5_sts}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="400" y="0" width="54" height="16" uuid="eea6acd1-c409-42a0-a803-393b73830d7e"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_5_val} > 0 ? $F{col_5_val} : ""]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="453" y="0" width="10" height="16" uuid="bd7e0c5d-b5d3-406a-912a-317333b891c6"/>
				<box leftPadding="1">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_6_sts}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="454" y="0" width="54" height="16" uuid="ac962f3a-5c07-48cb-89c7-fb654aafded6"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_6_val} > 0 ? $F{col_6_val} : ""]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="508" y="0" width="10" height="16" uuid="f8cbca0d-7b26-4e04-84ef-2478c4b4d613"/>
				<box leftPadding="1">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_7_sts}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="508" y="0" width="54" height="16" uuid="70af84a3-1ea7-4dc7-bfc5-644d82253890"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_7_val} > 0 ? $F{col_7_val} : ""]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="562" y="0" width="10" height="16" uuid="10c6a5f1-ee12-4e33-bae5-8ba199684dc5"/>
				<box leftPadding="1">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_8_sts}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="562" y="0" width="54" height="16" uuid="1d3d6e01-613b-40d7-8dc9-6cc9f24450ec"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_8_val} > 0 ? $F{col_8_val} : ""]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="616" y="0" width="10" height="16" uuid="53743c76-de5f-4e96-82ef-3895650d9d8b"/>
				<box leftPadding="1">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_9_sts}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="616" y="0" width="54" height="16" uuid="53d4f313-1700-443a-af86-f2372738ecaf"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_9_val} > 0 ? $F{col_9_val} : ""]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="670" y="0" width="10" height="16" uuid="c3376b30-7f38-43ef-ac44-87ffc2b1d327"/>
				<box leftPadding="1">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_10_sts}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="670" y="0" width="54" height="16" uuid="c853d543-75c0-4d38-bf0c-472ec2844a7e"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_10_val} > 0 ? $F{col_10_val} : ""]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="724" y="0" width="10" height="16" uuid="00e2f256-c950-43d0-9ae8-cfab916a9fa8"/>
				<box leftPadding="1">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_11_sts}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="724" y="0" width="54" height="16" uuid="66889954-1860-4611-991a-c49074162a90"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_11_val} > 0 ? $F{col_11_val} : ""]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="778" y="0" width="10" height="16" uuid="f6081a7e-45cb-498b-a9c8-876e7d810c6b"/>
				<box leftPadding="1">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_12_sts}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="778" y="0" width="54" height="16" uuid="160d8eea-99d7-4183-85b1-c3a9bce2f5d2"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{col_12_val} > 0 ? $F{col_12_val} : ""]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="894" y="0" width="62" height="16" uuid="9d0e1726-dc1f-4beb-acbe-fc0f9db0d0a9"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{prev_year_val} > 0 ? $F{prev_year_val} : ""]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="832" y="0" width="62" height="16" uuid="5a0e6f48-5481-420c-beb7-2b22bc7d3417"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{curr_year_val} > 0 ? $F{curr_year_val} : ""]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="957" y="0" width="32" height="16" uuid="e36c6706-4a76-4c5a-806e-972914cbb0a4"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[($F{curr_year_val}/$F{prev_year_val})*100 > 0 ?
    ($F{curr_year_val}/$F{prev_year_val})*100 : ""]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="15" splitType="Stretch">
			<textField>
				<reportElement x="15" y="1" width="111" height="14" uuid="83bd3527-532d-4030-954d-3b7428ff2300"/>
				<box rightPadding="5">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["TOTAL RAYON "+$F{sls_rayon}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="126" y="1" width="58" height="14" uuid="95667bd6-9eb0-4b6a-943c-a1e8e3c027e8"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{baddebt_lastyear_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="184" y="1" width="54" height="14" uuid="d8a303c7-4939-4e36-85ea-d21a84172381"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{col_1_val_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="238" y="1" width="54" height="14" uuid="d028e224-84f3-4733-a917-db50b902be7d"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{col_2_val_2}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="292" y="1" width="54" height="14" uuid="b616018f-9dda-4103-bcb1-fa065f0c1ca3"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{col_3_val_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="346" y="1" width="54" height="14" uuid="21491b54-89c9-4fdf-b010-d5192a1ee9a5"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{col_4_val_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="400" y="1" width="54" height="14" uuid="7e20c438-c3b4-4fc5-86d4-315cb81eacdd"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{col_5_val_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="454" y="1" width="54" height="14" uuid="ab2c5f48-c1dc-4518-9f71-222e3f5f327d"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{col_6_val_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="508" y="1" width="54" height="14" uuid="534e8cbd-7636-48b6-8fdc-0b226b5fe586"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{col_7_val_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="562" y="1" width="54" height="14" uuid="6349d0d2-15c1-4fd7-911a-4bfa4f2232c6"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{col_8_val_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="616" y="1" width="54" height="14" uuid="5b1e3050-7109-4ac1-808b-5a6cde7844b8"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{col_9_val_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="670" y="1" width="54" height="14" uuid="c750f938-6f6b-490a-aa4e-46ede2b84830"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{col_10_val_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="724" y="1" width="54" height="14" uuid="d22c8928-8366-4450-8d7b-03d5f4d982c5"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{col_11_val_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="778" y="1" width="54" height="14" uuid="f6daf6a9-08df-4b06-ab67-93836c806a8d"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{col_12_val_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="832" y="1" width="62" height="14" uuid="6abefea3-d357-4930-ab1d-80708be3af44"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{curr_year_val_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="894" y="1" width="62" height="14" uuid="7d56993d-394d-4a19-b084-3c7a6fcee80c"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{prev_year_val_1}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="0" y="1" width="15" height="14" uuid="1c436a52-d4e2-4bd4-b4dc-4476fc556889"/>
				<box rightPadding="5">
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="956" y="1" width="33" height="14" uuid="2cc38bf2-d01c-4614-b6ba-2dbcb6e52b77"/>
				<box rightPadding="3">
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[($V{curr_year_val_1}/$V{prev_year_val_1})*100 > 0 ?
    ($V{curr_year_val_1}/$V{prev_year_val_1})*100 : ""]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
